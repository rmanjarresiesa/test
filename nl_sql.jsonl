{"nl":"Cual es el valor total de las ventas por Item","sql":"SELECT (CONCAT('$',CONVERT(varchar,SUM(case when f461_id_moneda_docto = f010_id_moneda_local then f470_vlr_bruto * (case f470_ind_naturaleza when 1 then -1 else 1 end) else f470_vlr_bruto_alt * (case f470_ind_naturaleza when 1 then -1 else 1 end) end),1033))) AS 'Valor Total Ventas Item', f120_descripcion AS 'Item' FROM t350_co_docto_contable t350_fact INNER JOIN t461_cm_docto_factura_venta ON f461_rowid_docto = t350_fact.f350_rowid INNER JOIN t470_cm_movto_invent ON f470_rowid_docto_fact = f461_rowid_docto INNER JOIN t120_mc_items ON f470_rowid_item_ext = f120_rowid LEFT JOIN t010_mm_companias on f010_id = f461_id_cia GROUP BY f120_rowid, f120_descripcion;"}
{"nl":"Selecciona los 5 productos más vendidos para el año 2022 y muestra la cantidad vendida con la unidad de medida","sql":"SELECT TOP 5 f120_descripcion AS 'Producto',FORMAT(CONVERT(int, SUM(f470_cant_1)), 'N0', 'de-de') AS 'Cantidad Vendida', f470_id_unidad_medida AS 'Unidad de Medida' FROM t350_co_docto_contable t350_fact INNER JOIN t461_cm_docto_factura_venta ON f461_rowid_docto = t350_fact.f350_rowid INNER JOIN t470_cm_movto_invent ON f470_rowid_docto_fact = f461_rowid_docto INNER JOIN t120_mc_items ON f470_rowid_item_ext = f120_rowid WHERE f461_id_cia = 100 AND YEAR(f461_id_fecha) = 2022 GROUP BY f120_descripcion, f470_id_unidad_medida ORDER BY SUM(f470_cant_1) DESC;"}
{"nl":"Genera las ventas diarias del mes de enero 2023","sql":"SELECT f461_id_fecha AS 'Fecha',CONCAT('$',FORMAT(SUM(case when f461_id_moneda_docto = f010_id_moneda_local then f470_vlr_bruto * (case f470_ind_naturaleza when 1 then -1 else 1 end) else f470_vlr_bruto_alt * (case f470_ind_naturaleza when 1 then -1 else 1 end) end),'N2')) AS 'Valor Total' FROM t350_co_docto_contable t350_fact INNER JOIN t461_cm_docto_factura_venta ON f461_rowid_docto = t350_fact.f350_rowid INNER JOIN t470_cm_movto_invent ON f470_rowid_docto_fact = f461_rowid_docto LEFT JOIN t010_mm_companias on f010_id = f461_id_cia WHERE MONTH(f461_id_fecha) = 1 AND YEAR(f461_id_fecha) = 2023 GROUP BY f461_id_fecha ORDER BY f461_id_fecha;"}
{"nl":"Total ventas por sucursal y estado de factura","sql":"SELECT t201_fact.f201_descripcion_sucursal AS 'Sucursal',CASE t350_fact.f350_ind_estado WHEN 0 THEN 'En elaboración' WHEN 1 THEN 'Aprobada' WHEN 2 THEN 'Anulada' END AS 'Estado', CONCAT('$',FORMAT(SUM(case when f461_id_moneda_docto = f010_id_moneda_local then f470_vlr_bruto * (case f470_ind_naturaleza when 1 then -1 else 1 end) else f470_vlr_bruto_alt * (case f470_ind_naturaleza when 1 then -1 else 1 end) end),'N2')) AS 'Total Ventas' FROM t350_co_docto_contable t350_fact INNER JOIN t461_cm_docto_factura_venta ON f461_rowid_docto = t350_fact.f350_rowid INNER JOIN t470_cm_movto_invent ON f470_rowid_docto_fact = f461_rowid_docto INNER JOIN t201_mm_clientes t201_fact ON f201_id_sucursal = f461_id_sucursal_fact GROUP BY t201_fact.f201_descripcion_sucursal, t350_fact.f350_ind_estado ORDER BY t201_fact.f201_descripcion_sucursal;"}
{"nl":"Cuales son los articulos con el mayor retorno de inversion","sql":"SELECT f120_descripcion AS 'Producto', CONCAT('$',FORMAT(SUM(case when f461_id_moneda_docto = f010_id_moneda_local then f470_vlr_bruto * (case f470_ind_naturaleza when 1 then -1 else 1 end) else f470_vlr_bruto_alt * (case f470_ind_naturaleza when 1 then -1 else 1 end) end),'N2')) AS 'Valor Total Ventas' FROM t350_co_docto_contable t350_fact INNER JOIN t461_cm_docto_factura_venta ON f461_rowid_docto = t350_fact.f350_rowid INNER JOIN t470_cm_movto_invent ON f470_rowid_docto_fact = f461_rowid_docto INNER JOIN t120_mc_items ON f470_rowid_item_ext = f120_rowid LEFT JOIN t010_mm_companias on f010_id = f461_id_cia WHERE f461_id_cia = 100 GROUP BY f120_descripcion ORDER BY SUM(case when f461_id_moneda_docto = f010_id_moneda_local then f470_vlr_bruto * (case f470_ind_naturaleza when 1 then -1 else 1 end) else f470_vlr_bruto_alt * (case f470_ind_naturaleza when 1 then -1 else 1 end) end) DESC;"}
